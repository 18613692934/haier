<!DOCTYPE html> 
    <html>
    <head>
        <title>{:C('WEB_TITLE')}</title>
        {:W('Public/_meta')}
        <meta name=GENERATOR content="MShtml 8.00.7601.17514">
            <meta name="keywords" />
        <link rel="stylesheet" type="text/css" href="__HOME_CSS__/device_pest.css">
            <link rel="stylesheet" type="text/css" href="__HOME_CSS__/device_pest_history.css">
            
        <link rel="stylesheet" type="text/css" href="__HOME_CSS__/device_search.css">
        <link rel="stylesheet" type="text/css" href="__HOME_CSS__/device_manage.css">
        <script src="__HOME_JS__/jquery-1.8.3.min.js" type="text/javascript"></script>
        
    </head>
    <body>
        <div class="pest-wrap">
           <include file="Public/device_header"/>
           <div class="elements">
        <div class="cent but but_called">设备选项</div>
        <div class="info">
                <ul class="options">
                 <li>
                     <form id="switch">
                        <div class="opInfo">
                            <div class="info_info mt20">
                                <div class="info_time"><h4>装置开关</h4></div>
                                <div class="info_time">————————</div>
                            </div>
                            <div class="blank"></div>
                            <div>
                                <div class="blank"></div>
                                
                                <div class="blank"></div>
                                <div class="info_info tes mt5">
                                    <div class="info_time fl mt5">装置运行时间(小时:分钟)：</div>
                                    <div class="info_time fl s mt5">
                                        开始时间:<input type="text" name='statrTime' onfocus=<literal>"WdatePicker({dateFmt:' HH:mm'})"</literal> id="statrTime" class="input-text radius Wdate" style="width:130px;">
                                    </div>
                                    <div class="info_time fl s mt5">
                                        结束时间:<input type="text" name='endTime' onfocus=<literal>"WdatePicker({dateFmt:' HH:mm', minDate: '#F{$dp.$D(\'statrTime\')}' })"</literal> id="endTime" class="input-text radius Wdate" style="width:130px;">
                                    </div>
                                </div>
                                <div class="blank"></div>
                                <div class="info_info tes mt5">
                                    <div class="info_time fl">球机开关：</div>
                                    <div class="info_time fr">
                                        <div class="fangzhi fr">
                                         <div class="fangzhi fr">
                                            <input type="checkbox" id="checked2" name="dome" class="cbx hidden" checked/>
                                            <label for="checked2" class="lbl">开 关</label>
                                        </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="blank"></div>
                                
                                <div class="blank"></div>
                                
                                <div class="blank"></div>
                                <div class="info_info demo">
                                    <button class="btn btn-primary radius" type="submit" onclick="form_manage(this)" >发送命令</button>
                                </div>
                            </div>
                        </div>
                 </form>
                    </li>
                 <li>
                     <form id="frequency">	 
                        <div class="opInfo">
                            <div class="info_info mt20">
                                <div class="info_time"><h4>频次调节</h4></div>
                                <div class="info_time">————————</div>
                            </div>
                            <div class="blank"></div>
                            <div>
                                
                                <div class="blank"></div>
                                
                                <div class="info_info tes mt5">																		
                                    <div class="infoTxt fl">内部摄像头拍摄:</div>
                                    
                                    <input class="timeTxt .tes fl" value="" name="shot" id="test1">
                                        
                                    <div class="info_time fl">分钟/次</div>
                                </div>
                                
                                <div class="blank"></div>
                                
                                <div class="info_info tes mt5">																		
									
                                    <div class="infoTxt fl">环境数据采集:</div>
                                    <input class="timeTxt fl" value="" name="gather" id="test1">
                                    <div class="info_time fl">分钟/次</div>
								
                                </div>
                               
                               
                                <div class="blank"></div>                              
                               
                                <div class="blank"></div>                                  
                                <div class="info_info demo mt20">
                                   <button class="btn btn-primary radius" type="submit" onclick="form_manage(this)" >发送命令</button>
                                </div>
                            </div>
                        </div>
                 </form>
                    </li>
  <li>
      <form id="alert">	 
                        <div class="opInfo">
                            <div class="info_info mt20">
                                <div class="info_time"><h4>信息报警</h4></div>
                                <div class="info_time">————————</div>
                            </div>
                            <div class="blank"></div>
                            <div>
                                <div class="blank"></div>
                                <div class="info_info tes mt5">																		
                                    <form>
                                     <div class="infoTxt fl">绑定手机:</div>
                                     <input class="timeTxt1 fl" value="" name="phone" id="test1">

                                    </form>
                                </div>
                               
                               
                               <div class="blank"></div>
                                <div class="info_info tes mt5">
                                    <div class="info_time fl">入侵信息发送</div>
                                    <div class="info_time fr">
                                        <div class="fangzhi fr">
                                         <div class="fangzhi fr">
                                            <input type="checkbox" id="checked5" name="invade" class="cbx hidden" checked/>
                                            <label for="checked5" class="lbl">开 关</label>
                                        </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="blank"></div> 
                                <div class="info_info tes mt5">
                                    <div class="info_time fl">火警信息发送</div>
                                    <div class="info_time fr">
                                        <div class="fangzhi fr">
                                         <div class="fangzhi fr">
                                            <input type="checkbox" id="checked6" name="fire" class="cbx hidden" checked/>
                                            <label for="checked6" class="lbl">开 关</label>
                                        </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="blank"></div>								
                                <div class="info_info demo mt20">
                                    <button class="btn btn-primary radius" type="submit" onclick="form_manage(this)" >发送命令</button>
                                
                                    
                                </div>
                            </div>
                        </div>
          </form>
                    </li>
 <li>
				 
                        <div class="opInfo">
                            <div class="info_info mt20">
                                <div class="info_time"><h4>电池电量</h4></div>
                                <div class="info_time">————————</div>
                            </div>
                             <div id="main" style="width: 100%;height:200px; margin:0 auto;"></div>
                        </div>
                    </li>					
 </ul>
        </div>
    </div>
    <div class="blank"></div>
</div>
</body> 
    {:W('Public/_footer')}
<script type="text/javascript" src="__PUBLIC_STATIC__/My97DatePicker/4.8/WdatePicker.js"></script>
<script type="text/javascript" src="__PUBLIC_STATIC__/jquery.validation/1.14.0/jquery.validate.js"></script> 
<script type="text/javascript" src="__PUBLIC_STATIC__/jquery.validation/1.14.0/validate-methods.js"></script> 
<script type="text/javascript" src="__PUBLIC_STATIC__/jquery.validation/1.14.0/messages_zh.js"></script>
<script type="text/javascript" src="__HOME_JS__/echarts.js"></script>
<script>
     var myChart = echarts.init(document.getElementById('main'));
        option = {
    tooltip: {
        trigger: 'axis',
        axisPointer: { // 坐标轴指示器，坐标轴触发有效
            type: 'shadow' // 默认为直线，可选为：'line' | 'shadow'
        },
        formatter: function(params) {
            return params[0].name + '<br/>' 
            +params[0].seriesName + ' : ' + params[0].value;
        }
    },
    legend: {
        show: false,
        selectedMode: false,
        data: ['剩余电量']
    },
    xAxis: [{
        show: false,
        type: 'category',
        data: ['电量'],
        boundaryGap: false
    }],
    yAxis: [{
        show: false,
        type: 'value',
        max: 100,
        boundaryGap: [0, 0.1]
    }],
    grid: [{
        x: 0,
        y: 0,
        x2: 0,
        y2: 0
    }],
    series: [{
        name: '剩余电量',
        type: 'bar',
        stack: 'sum',
        barCategoryGap: '0%',
        barWidth: '100',
        itemStyle: {
            normal: {
                color: '#1d6ee3',
                barBorderColor: '#C4C4C4',
                barBorderWidth: 6,
                barBorderRadius: 0,
                label: {
                    show: true,
                    position: 'insideTop'
                }
            }
        },
        data: [50]
    }, 
    {
        name: '满电量',
        type: 'bar',
        stack: 'sum',
        itemStyle: {
            normal: {
                color: '#fff',
                barBorderColor: '#C4C4C4',
                barBorderWidth: 6,
                barBorderRadius: [10, 10, 0, 0],
//               
            }
        },
        data: [50]
    }
]
};
  
         // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
</script>
<script>
       
       $('.fangzhi').click(function () {
           if($(this).attr('class')=='fbut'){
               $(this).addClass('fbut_called');
               $(this).prev().removeClass('fbut_called');
           }else{
               $(this).removeClass('fbut_called');
               $(this).next().addClass('fbut_called');
           }

       })
    </script>
<include file="Public/device_footer"/>
                               
<script>
    //表单验证
        function form_manage(obj){
            var id = obj.form.id ;
            $("#"+id+"").validate({
                rules:{
			statrTime:{
				required:true,
			},
			endTime:{
                            required:true,
			},
                        //环境数据采集频次
                        gather:{
                           required:true,
                           digits:true
                        },
                        //内部摄像头拍照频次
                        shot:{
                           required:true,
                           digits:true
                        },
                        phone:{
                            required:true,
                            digits:true,
                           rangelength:[11,11]
                        },
                        
                        
		},
                messages:{
                    statrTime:{
                            required:"这是必填字段",
			},
			endTime:{
                          required:"这是必填字段",
			},
                        gather:{
                           required:"这是必填字段",
                           digits: "只能输入数字",
                        },
                        shot:{
                           required:"这是必填字段",
                           digits: "只能输入数字",
                        },
                        phone:{
                           required:"这是必填字段",
                           digits: "只能输入数字",
                           rangelength: $.validator.format("请输入11位的手机号"),
                        },
                       
                },
		onkeyup:false,
		focusCleanup:true,
		success:"valid",
		submitHandler:function(form){
                    $(form).ajaxSubmit({
                        type:'post',
                        data:{'type':id},
                        url:"{:U('Device/manage')}",
                        success:function(data){
                            if(data == true){
                                 layer.msg('命令发送成功!',{icon:1,time:2000});
                            }else if(data ==false){
                                layer.msg('命令发送失败!',{icon:1,time:2000});
                            }else if(data.length > 100){
                                 layer.msg('命令发送失败!',{icon:1,time:2000});
                            }
                            
                           

                        },
                        error:function(XmlHttpRequest, textStatus, errorThrown){
 
                            layer.msg('请联系管理员!',{icon:1,time:2000});
                        },
                        
                        
                    });
			
//                        setTimeout(function(){
//                            window.location.reload(); //刷新父页面
//                        },1000);
			
		}
	});
        }
	
</script>
</html>
